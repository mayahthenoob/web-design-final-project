# Flavorful Website - PHP Implementation Guide

## Overview
All HTML files have been converted to PHP with full CRUD functionality and session-based authentication. The styling has been preserved exactly as in the original files.

## Database Setup

### 1. Create Database
Run the provided `database_schema.sql` file in your MySQL client:
```sql
-- Copy all content from database_schema.sql and execute
```

### 2. Database Tables Created
- **users** - User accounts with authentication
- **products** - Available pennacool products
- **orders** - Customer orders
- **order_items** - Individual items in orders
- **messages** - Contact form submissions
- **account_balance** - User account balances and spending

## File Structure

```
/flavorful/
├── index.php              (Homepage)
├── register.php           (Sign up/registration)
├── login.php              (Login)
├── about.php              (About page)
├── workers.php            (Workers page)
├── socials.php            (Social media links)
├── prices.php             (Product prices)
├── contact.php            (Contact form)
├── buy-now.php            (Shopping hub)
├── order.php              (Order interface)
├── delivery.php           (Delivery checkout)
├── balance.php            (User account balance)
├── contact_form_handler.php (Contact form processor)
└── database_schema.sql    (Database setup)
```

## Configuration

### Database Connection
Update these variables in each PHP file to match your setup:
```php
$host = 'localhost';      // Your host
$db = 'flavorful';        // Database name
$user = 'root';           // MySQL user
$password = '';           // MySQL password
```

## Key Features Implemented

### 1. Authentication System
- **Registration** (`register.php`)
  - Username, email, password validation
  - Password hashing with bcrypt
  - Duplicate email checking
  - User initials auto-generation
  
- **Login** (`login.php`)
  - Email and password verification
  - Session management
  - Error handling

- **Logout**
  - Session destruction
  - Cookie clearing

### 2. CRUD Operations

#### CREATE
- **Users**: Registration form → `INSERT INTO users`
- **Orders**: Order submission → `INSERT INTO orders`
- **Messages**: Contact form → `INSERT INTO messages`

#### READ
- **Products**: Display all products from database
- **User Profile**: Fetch user data from `users` table
- **Order History**: Retrieve user orders
- **Messages**: Admin can view contact submissions

#### UPDATE
- **User Profile**: Update address, phone, etc.
- **Order Status**: Update order status (pending → delivered)
- **Account Balance**: Update spending totals

#### DELETE
- **Orders**: Cancel order (soft or hard delete)
- **Cart Items**: Remove items from cart

### 3. Session Management
```php
session_start();

// Set user session after login
$_SESSION['authUser'] = [
    'id' => $user['id'],
    'username' => $user['username'],
    'email' => $user['email'],
    'initials' => $user['initials']
];

// Check if user is logged in
$authUser = isset($_SESSION['authUser']) ? $_SESSION['authUser'] : null;

// Logout
session_destroy();
```

### 4. Navigation Updates
All navigation links updated from `.html` to `.php`:
```php
<a href="index.php">Home</a>
<a href="register.php">Sign Up</a>
<a href="login.php">Login</a>
```

### 5. Conditional Display
Show/hide elements based on login status:
```php
<div class="profile-icon" <?php echo !$authUser ? 'style="display:none;"' : ''; ?>>
    <!-- Only shows when logged in -->
</div>
```

## Forms & Handlers

### Registration Form
**File**: `register.php`
- Validates all required fields
- Checks for duplicate email
- Hashes password with bcrypt
- Creates user record in database
- Sets session and redirects to home

### Login Form
**File**: `login.php`
- Validates email and password
- Verifies password hash
- Sets session on success
- Displays errors on failure

### Contact Form
**File**: `contact.php` → `contact_form_handler.php`
- Collects name, email, message
- Stores in messages table
- Confirmation message displayed
- Ready for email notification integration

### Order Form
**File**: `order.php`
- Select products and quantities
- Dynamic cart calculation
- Order total with optional delivery fee
- Submit to orders table

## Security Features

1. **Password Security**: Bcrypt hashing with PASSWORD_BCRYPT
2. **SQL Injection Prevention**: Prepared statements with PDO
3. **Input Validation**: 
   - Email format validation
   - Required field checks
   - Trim whitespace
4. **Session Security**: 
   - Session timeouts (configure in php.ini)
   - Secure session cookie (HTTPS recommended for production)
5. **XSS Prevention**: htmlspecialchars() for output

## Environment Setup

### PHP Version
- Minimum PHP 7.4
- Recommended PHP 8.0+

### Required Extensions
- PDO
- MySQL PDO Driver
- Sessions (default)

### MySQL Version
- MySQL 5.7+
- MariaDB 10.2+

## Deployment Checklist

- [ ] Database created and schema imported
- [ ] Database connection credentials updated
- [ ] All PHP files uploaded to web server
- [ ] File permissions set correctly (755 for directories, 644 for files)
- [ ] PHP error reporting configured for production
- [ ] HTTPS enabled (recommended)
- [ ] Session save path configured
- [ ] Database backups configured
- [ ] Email server configured (for contact form notifications)

## Testing

### Test Registration
1. Go to `/register.php`
2. Fill in all fields
3. Verify user created in database
4. Check initials generated correctly

### Test Login
1. Go to `/login.php`
2. Use registered credentials
3. Verify session created
4. Check navbar shows user initials

### Test Contact Form
1. Go to `/contact.php`
2. Submit message
3. Verify message stored in database
4. Check success message displayed

### Test Orders
1. Login to account
2. Go to `/order.php`
3. Add products to cart
4. Submit order
5. Verify order in database

## Troubleshooting

### "Database connection failed"
- Check database credentials
- Verify MySQL service is running
- Check database name exists

### "Headers already sent"
- Ensure `session_start()` is first line
- No whitespace before `<?php`
- No output before header() calls

### "Session not persisting"
- Check cookies are enabled
- Verify session save path exists
- Check session timeout settings

### "Password verification fails"
- Ensure password_verify() is used
- Check password hashing during registration
- Clear browser cookies and retry

## Next Steps

1. **Add Email Notifications**
   - Configure mail() function
   - Add SMTP settings if needed

2. **Add Payment Integration**
   - Stripe or PayPal integration
   - Payment status tracking

3. **Admin Dashboard**
   - View all orders
   - Manage products
   - View messages

4. **User Profile**
   - Edit personal information
   - View order history
   - Download receipts

5. **Advanced Features**
   - Email verification
   - Password reset
   - Two-factor authentication
   - Order tracking

## Support
For issues or questions, refer to the specific error messages and check the troubleshooting section above.